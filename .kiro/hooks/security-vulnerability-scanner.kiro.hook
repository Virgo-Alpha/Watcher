{
  "enabled": true,
  "name": "Security Vulnerability Scanner",
  "description": "Monitors file changes across the codebase and performs security vulnerability analysis to detect potential security issues introduced in code updates",
  "version": "1",
  "when": {
    "type": "fileEdited",
    "patterns": [
      "backend/**/*.py",
      "frontend/src/**/*.tsx",
      "frontend/src/**/*.ts",
      "backend/requirements.txt",
      "frontend/package.json",
      "docker-compose.yml",
      "backend/watcher/settings/**/*.py"
    ]
  },
  "then": {
    "type": "askAgent",
    "prompt": "A file has been updated in the codebase. Please perform a comprehensive security vulnerability analysis on the changed file(s). Check for:\n\n1. **Authentication & Authorization Issues**: Improper access controls, missing authentication checks, privilege escalation vulnerabilities\n2. **Input Validation**: SQL injection, XSS, command injection, path traversal vulnerabilities\n3. **Data Exposure**: Sensitive data leaks, improper logging of secrets, hardcoded credentials\n4. **Dependency Vulnerabilities**: Known CVEs in new or updated dependencies\n5. **Configuration Security**: Insecure settings, exposed debug modes, weak security headers\n6. **API Security**: Missing rate limiting, improper CORS configuration, insecure endpoints\n7. **Cryptographic Issues**: Weak encryption, improper key management, insecure random generation\n\nIf any security vulnerabilities are detected:\n- **RAISE ALARM**: Clearly state \"ðŸš¨ SECURITY VULNERABILITY DETECTED ðŸš¨\"\n- **Severity Level**: Rate as CRITICAL, HIGH, MEDIUM, or LOW\n- **Vulnerability Type**: Specify the category (e.g., \"SQL Injection\", \"XSS\", \"Authentication Bypass\")\n- **Location**: Exact file path and line numbers\n- **Description**: Clear explanation of the vulnerability and potential impact\n- **Suggested Fix**: Provide specific code changes or security measures to remediate the issue\n- **Prevention**: Recommend practices to prevent similar issues in the future\n\nIf no vulnerabilities are found, provide a brief \"âœ… Security scan complete - no vulnerabilities detected\" message."
  }
}